---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getLangFromUrl, useTranslations } from "../utils/i18n";
import { getGitHubUser } from "../utils/github";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const githubUser = await getGitHubUser("Lenny606");
const experience = [
    {
        title: "Senior Full-stack Vývojář",
        company: "Freelance / Vlastní projekty",
        period: "2022 - Současnost",
        description:
            "Vývoj komplexních webových aplikací s využitím React, Astro a Node.js. Implementace AI automatizací pomocí n8n a Langgraph.",
    },
    {
        title: "Full-stack Vývojář",
        company: "Digitální agentura",
        period: "2019 - 2022",
        description:
            "Tvorba a správa klientských projektů od e-shopů po korporátní weby s využitím PHP, Reactu a Pythonu.",
    },
];

const education = [
    {
        degree: "Bakalář informatiky",
        school: "Technická univerzita",
        period: "2015 - 2018",
    },
];

const skills = [
    {
        category: "Frontend",
        items: ["React", "Astro", "Tailwind CSS", "TypeScript"],
    },
    { category: "Backend", items: ["Node.js", "Python", "PHP", "PostgreSQL"] },
    {
        category: "AI & Automatizace",
        items: ["n8n", "Langgraph", "OpenAI API"],
    },
];
---

<BaseLayout title={`${t("cv.title")} | TomasAstro`}>
    <section class="max-w-5xl mx-auto px-6 py-12">
        <div class="mb-20 text-center">
            <h1
                class="text-6xl md:text-8xl font-serif mb-6 animate-in fade-in slide-in-from-bottom-8 duration-1000"
            >
                {t("cv.title")}
            </h1>
            <p class="text-xl text-zinc-400 font-light max-w-2xl mx-auto">
                {t("cv.subtitle")}
            </p>
        </div>

        {
            githubUser && (
                <div class="mb-32 animate-in fade-in duration-1000">
                    <div class="flex flex-col md:flex-row items-center gap-10 p-10 bg-zinc-900/50 border border-white/5 rounded-t-2xl">
                        <img
                            src={githubUser.avatar_url}
                            alt={githubUser.name || githubUser.login}
                            class="w-32 h-32 rounded-full border-2 border-white/10 p-1"
                        />
                        <div class="text-center md:text-left flex-1">
                            <div class="flex flex-col md:flex-row md:items-end gap-4 mb-4">
                                <h2 class="text-3xl font-serif">
                                    {githubUser.name || githubUser.login}
                                </h2>
                                <span class="text-zinc-500 uppercase tracking-widest text-xs mb-1">
                                    @{githubUser.login}
                                </span>
                            </div>
                            <p class="text-zinc-400 mb-6 max-w-xl leading-relaxed">
                                {githubUser.bio}
                            </p>
                            <div class="flex flex-wrap justify-center md:justify-start gap-8">
                                <div class="flex flex-col">
                                    <span class="text-2xl font-bold">
                                        {githubUser.public_repos}
                                    </span>
                                    <span class="text-[10px] uppercase tracking-widest text-zinc-500 font-bold">
                                        Repos
                                    </span>
                                </div>
                                <div class="flex flex-col">
                                    <span class="text-2xl font-bold">
                                        {githubUser.followers}
                                    </span>
                                    <span class="text-[10px] uppercase tracking-widest text-zinc-500 font-bold">
                                        Followers
                                    </span>
                                </div>
                                <div class="flex flex-col">
                                    <span class="text-2xl font-bold">
                                        {githubUser.location || "Remote"}
                                    </span>
                                    <span class="text-[10px] uppercase tracking-widest text-zinc-500 font-bold">
                                        Location
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-px bg-white/5 border-x border-b border-white/5 rounded-b-2xl overflow-hidden">
                        {githubUser.languages &&
                            githubUser.languages.length > 0 && (
                                <div class="p-8 bg-zinc-900/30">
                                    <h3 class="text-xs uppercase tracking-[0.3em] text-zinc-500 mb-4 font-bold">
                                        {t("cv.languages")}
                                    </h3>
                                    <div class="flex flex-wrap gap-2">
                                        {githubUser.languages
                                            .slice(0, 6)
                                            .map((lang) => (
                                                <span class="px-3 py-1 bg-white/5 rounded-full text-xs text-zinc-300 border border-white/5">
                                                    {lang}
                                                </span>
                                            ))}
                                    </div>
                                </div>
                            )}

                        {githubUser.techStack &&
                            githubUser.techStack.length > 0 && (
                                <div class="p-8 bg-zinc-900/30">
                                    <h3 class="text-xs uppercase tracking-[0.3em] text-zinc-500 mb-4 font-bold">
                                        {t("cv.techstack")}
                                    </h3>
                                    <div class="flex flex-wrap gap-2">
                                        {githubUser.techStack
                                            .slice(0, 8)
                                            .map((tech) => (
                                                <span class="px-3 py-1 bg-zinc-800/50 rounded-full text-xs text-zinc-400 border border-white/5 capitalize">
                                                    {tech.replace(/-/g, " ")}
                                                </span>
                                            ))}
                                    </div>
                                </div>
                            )}
                    </div>
                </div>
            )
        }

        <div class="space-y-24">
            <!-- Experience -->
            <section>
                <h2
                    class="text-3xl font-serif mb-12 border-b border-white/10 pb-4"
                >
                    {t("cv.experience")}
                </h2>
                <div class="space-y-12">
                    {
                        experience.map((item) => (
                            <div class="grid grid-cols-1 md:grid-cols-[200px_1fr] gap-8">
                                <div class="text-zinc-500 font-medium tracking-wider">
                                    {item.period}
                                </div>
                                <div>
                                    <h3 class="text-2xl font-bold mb-1">
                                        {item.title}
                                    </h3>
                                    <p class="text-zinc-400 mb-4">
                                        {item.company}
                                    </p>
                                    <p class="text-zinc-500 leading-relaxed max-w-2xl">
                                        {item.description}
                                    </p>
                                </div>
                            </div>
                        ))
                    }
                </div>
            </section>

            <!-- Education -->
            <section>
                <h2
                    class="text-3xl font-serif mb-12 border-b border-white/10 pb-4"
                >
                    {t("cv.education")}
                </h2>
                <div class="space-y-12">
                    {
                        education.map((item) => (
                            <div class="grid grid-cols-1 md:grid-cols-[200px_1fr] gap-8">
                                <div class="text-zinc-500 font-medium tracking-wider">
                                    {item.period}
                                </div>
                                <div>
                                    <h3 class="text-2xl font-bold mb-1">
                                        {item.degree}
                                    </h3>
                                    <p class="text-zinc-400">{item.school}</p>
                                </div>
                            </div>
                        ))
                    }
                </div>
            </section>

            <!-- Skills -->
            <section>
                <h2
                    class="text-3xl font-serif mb-12 border-b border-white/10 pb-4"
                >
                    {t("cv.skills")}
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-12">
                    {
                        skills.map((skill) => (
                            <div>
                                <h3 class="text-xs uppercase tracking-[0.3em] text-zinc-500 mb-6 font-bold">
                                    {skill.category}
                                </h3>
                                <ul class="space-y-3">
                                    {skill.items.map((item) => (
                                        <li class="text-zinc-300 flex items-center gap-3">
                                            <div class="w-1.5 h-1.5 bg-zinc-700 rounded-full" />
                                            {item}
                                        </li>
                                    ))}
                                </ul>
                            </div>
                        ))
                    }
                </div>
            </section>
        </div>

        <div class="mt-32 text-center">
            <button
                class="inline-flex items-center gap-4 px-10 py-5 bg-white text-black rounded-full hover:bg-zinc-200 transition-all duration-300 font-bold uppercase tracking-widest text-sm"
                onclick="window.print()"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                >
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                {t("cv.download")}
            </button>
        </div>
    </section>
</BaseLayout>

<style>
    @media print {
        :global(nav),
        :global(footer),
        .download-btn {
            display: none !important;
        }
        section {
            padding: 0 !important;
            margin: 0 !important;
        }
        .max-w-5xl {
            max-width: 100% !important;
        }
    }
</style>
