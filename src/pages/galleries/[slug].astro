---
import BaseLayout from "../../layouts/BaseLayout.astro";
import GalleryGrid from "../../components/GalleryGrid.astro";
import GalleryCard from "../../components/GalleryCard.astro";
import { galleryService } from "../../services/gallery-service";
import { getLangFromUrl, useTranslations } from "../../utils/i18n";

const { slug } = Astro.params;
const gallery = await galleryService.getGalleryBySlug(slug as string);

if (!gallery) {
    return Astro.redirect("/404");
}

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<BaseLayout title={`${gallery.title} | Galleries`}>
    <section class="max-w-7xl mx-auto px-12 pt-16 pb-32">
        <div class="mb-20">
            <a
                href="/galleries"
                class="text-xs uppercase tracking-[0.2em] font-bold text-zinc-500 hover:text-white transition-colors mb-12 inline-block"
            >
                {t("galleries.back")}
            </a>
            <div class="max-w-4xl">
                <h1
                    class="text-7xl md:text-9xl font-serif tracking-tight mb-8 animate-in fade-in slide-in-from-bottom-8 duration-1000"
                >
                    {gallery.title}
                </h1>
                <p
                    class="text-2xl text-zinc-400 font-light max-w-2xl leading-relaxed"
                >
                    {gallery.description}
                </p>
            </div>
        </div>

        <GalleryGrid columns={3}>
            {
                gallery.items?.map((item) => (
                    <GalleryCard
                        title={item.title}
                        description={item.medium}
                        image={item.url}
                        href={
                            item.pageUrl ??
                            `/galleries/${gallery.slug}/${item.slug}`
                        }
                        subtitle={item.year}
                    />
                ))
            }
        </GalleryGrid>
    </section>
</BaseLayout>
